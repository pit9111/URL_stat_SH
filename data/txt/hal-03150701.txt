Jointly estimating spatial sampling effort and habitat
suitability for multiple species from opportunistic
presence-only data
Christophe Botella, Alexis Joly, Pierre Bonnet, Fran√ßois Munoz, Pascal

Monestiez

To cite this version:

Christophe Botella, Alexis Joly, Pierre Bonnet, Fran√ßois Munoz, Pascal Monestiez. Jointly estimating
spatial sampling effort and habitat suitability for multiple species from opportunistic presence-only
data. Methods in Ecology and Evolution, 2021, 12 (5), pp.933-945. Ôøø10.1111/2041-210X.13565Ôøø. Ôøøhal-
03150701Ôøø

HAL Id: hal-03150701

https://hal.umontpellier.fr/hal-03150701

Submitted on 24 Feb 2021

HAL is a multi-disciplinary open access
archive for the deposit and dissemination of sci-
entific research documents, whether they are pub-
lished or not. The documents may come from
teaching and research institutions in France or
abroad, or from public or private research centers.

L‚Äôarchive ouverte pluridisciplinaire HAL, est
destin√©e au d√©p√¥t et √† la diffusion de documents
scientifiques de niveau recherche, publi√©s ou non,
√©manant des √©tablissements d‚Äôenseignement et de
recherche fran√ßais ou √©trangers, des laboratoires
publics ou priv√©s.

Received: 18 May 2019‚ÄÉ |‚ÄÉ Accepted: 19 January 2021
DOI: 10.1111/2041-210X.13565  

R E S E A R C H   A R T I C L E

Jointly estimating spatial sampling effort and habitat suitability 
for multiple species from opportunistic presence- only data

Christophe Botella1,2,3,4 ‚ÄÉ|   Alexis Joly1 ‚ÄÉ|   Pierre Bonnet3,5 ‚ÄÉ|   Fran√ßois Munoz6 ‚ÄÉ|   
Pascal Monestiez4

1INRIA Sophia- Antipolis -  ZENITH team, LIRMM -  UMR, Montpellier, France; 2INRAE, UMR AMAP, Montpellier, France; 3AMAP, University of Montpellier, 
CIRAD, CNRS, INRAE, IRD, Montpellier, France; 4INRAE, BioSP, Site Agroparc, Avignon, France; 5CIRAD, UMR AMAP, Montpellier, France and 6Laboratoire 
Interdisciplinaire de Physique, Universit√© Grenoble Alpes, Saint- Martin- d'H√®res, France

Correspondence
Christophe Botella
Email: christophe.botella@gmail.com

Handling Editor: Robert B. O‚ÄôHara

Abstract

1.  Building reliable species distribution models (SDMs) from presence- only informa-

tion  requires  a  good  understanding  of  the  spatial  variation  in  the  sampling  ef-

fort. However, in most cases, the sampling effort is unknown, leading to biases in 

SDMs. This study proposes a method to jointly estimate the parameters of sam-

pling effort and species densities to avoid such biases. The method is particularly 

suited to the analysis of massive but highly heterogeneous presence- only data.

2.  The proposed method is based on estimating the variation in sampling effort over 

units of a spatial mesh in parallel with the environmental density of multiple spe-

cies  using  a  marked  Poisson  process  model.  Based  on  simulations  with  realistic 

settings, we examined the performance and robustness of parameter estimations. 

We also analysed a large- scale citizen science dataset with highly heterogeneous 

sampling (Pl@ntNet), including around 300,000 occurrences of 150 plant species.

3.  We found that sampling effort was correctly estimated when the true sampling ef-

fort was constant within the cells of a spatial mesh. Estimation bias arose when sam-

pling  effort  and  environmental  drivers  strongly  covaried  within  cells.  Otherwise, 

the  inference  was  correct  and  robust  to  sampling  variation  within  cells.  Running 

the model on real occurrences of 150 plant species provided an estimated map of 

relative sampling effort for 15% of French territory. We also found that the density 

estimated for an exotic invasive plant was consistent with prior data.

4.  This is the first method jointly estimating species densities depending on environ-

ment, and sampling effort as an explicit spatial function, from occurrence data of 

multiple species. An asset of the method is that a few frequently observed species 

greatly contribute to correctly estimate sampling effort, thereby improving density 

estimation of all other species. This approach can thus provide reliable SDM for 

Alexis Joly and Pierre Bonnet contributed equally to the paper. 

Fran√ßois Munoz and Pascal Monestiez contributed equally to the paper.  

This is an open access article under the terms of the Creative Commons Attribution License, which permits use, distribution and reproduction in any medium, 
provided the original work is properly cited.
¬© 2021 The Authors. Methods in Ecology and Evolution published by John Wiley & Sons Ltd on behalf of British Ecological Society

Methods Ecol Evol. 2021;00:1‚Äì13. 

wileyonlinelibrary.com/journal/mee3 ‚ÄÉ|‚ÄÉ 1

 
 
2‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇMethods in Ecology and Evolu(cid:13)on

large opportunistic presence- only datasets, with broad spatial variation in sampling 

effort but also many species, such as datasets from citizen science programmes.

K E Y W O R D S

citizen science, marked Poisson point process, multi- species data, presence- only data, 

sampling effort, species distribution model, unbiased estimation

1‚ÄÉ| ‚ÄÉI NTRO D U C TI O N

factor  and  result  in  bias  in  SDM  results  (Beck  et  al.,  2014;  Boakes 

et al., 2010; Botella et al., 2020; Bystriakova et al., 2012; Costa et al., 

Understanding  biodiversity  dynamics  and  designing  conservation 

2010). Therefore, it is crucial to take sampling effort into account in 

strategies  require  characterizing  and  analysing  the  distribution  of 

SDMs. Several approaches have been proposed to tackle this problem. 

species  in  space  and  time.  Today,  international  citizen  science  proj-

Sampling effort can be approximated from external information about 

ects and naturalist networks provide massive geolocated occurrence 

the sampling protocol when available. Calenge et al. (2015) used the 

data for multiple species around the world. Yet, the observed distri-

number of driven kilometres reported by agents as an approximation 

bution of species occurrences depends not only on the actual species 

of the relative sampling effort when reporting the occurrence of dead 

abundance but also on the sampling effort of observers. To correctly 

animals on roadsides. Solan et al. (2019) provided another approach to 

estimate environmental effects in species distribution models (SDMs, 

estimate sampling effort from multi- species occurrence based on an a 

Elith & Leathwick, 2009), it is crucial to design a statistical approach 

priori model of sampling effort. Alternatively, when no external knowl-

that can separate these two intertwined signals in the data.

edge is available, the background points used for inference of the envi-

Until recently, digitized geolocated presence of species, or species 

ronmental density of a species (Warton et al., 2010) can approximate 

occurrences, were extracted from expert collections, mainly natural-

the  heterogeneous  sampling  effort.  Phillips  et  al.  (2009)  proposed 

ist field surveys and natural history museums (Sober√≥n & Peterson, 

the target- group background (TGB) procedure, in which sites with at 

2004). Today, species occurrence data have become widely available 

least  one  observation  of  a  target  group  of  species  are  integrated  as 

from worldwide citizen science programmes or naturalist community 

background points to provide a proxy of sampling effort. Bradter et al. 

platforms 

(e.g. 

iNaturalist,  e- Bird,  Pl@ntNet,  Naturgucker;  see 

(2018) proposed using information about the prospecting behaviour 

Chandler et al., 2017), in part thanks to new digital tools and smart-

and detection skills of very active reporters to infer the true absence 

phone applications (Teacher et al., 2013). For example, eBird has col-

of a species, and then integrating it into a presence‚Äì absence model-

lected around 500 million valid geolocated occurrences of bird species 
worldwide,  which  are  accessible  online  on  the  GBIF  website.1 

ling framework. Finally, Warton et al. (2013) proposed to jointly model 

sampling effort and species density, under the assumption that sam-

Moreover,  automatic  identification  of  images  or  sound  (Joly  et  al., 

pling effort depends on specific variables. Those variables reflect prior 

2018)  and  the  collaborative  review  of  observations  have  enhanced 

knowledge on what influences observers behaviour. Yet, the bias cor-

the  quality  of  species  identification  by  non- professional  observers. 

rection efficiency of the existing approaches is conditional on external 

However, contributors do not follow a planned sampling protocol and 

information or specific assumptions about sampling effort.

submit  observations  of  specimens  that  are  remarkable,  atypical  or 

In this study, we propose a new SDM method for multi- species 

new to them. Such 'opportunistic' sampling (Kery et al., 2010) reflects 

presence- only  data,  which  requires  less  prior  knowledge  about 

the  specific  behaviour  and  reporting  choices  of  contributors.  The 

the  sampling  process.  It  models  sampling  effort  as  a  common 

sampling  effort  is  then  neither  spatially  uniform  nor  balanced  be-

component  across  multiple  species,  and  as  a  step  function  with 

tween species. The objective of the present study is to propose a joint 

constant values within cells of a spatial mesh. Therefore, our sam-

estimation of spatial sampling effort and species ecological niches, to 

pling  effort  model  only  assumption  concerns  its  spatial  scale  of 

alleviate biases in SDMs due to heterogeneous sampling.

variation. This model is related to those spatial statistics models, 

Sampling  effort,  or  ‚Äòobservation  effort‚Äô  (Calenge  et  al.,  2015), 

where bases of spatially smooth functions, called smoothers, are 

is  defined  as  an  intensity  function  measuring  the  number  of  visits 

often used to estimate response surfaces in a computationally ef-

during which observers can report a specimen occurrence at a given 

ficient way when the number of samples is large (Johannesson & 

point. Here, we assume that sampling effort does not depend on spe-

Cressie,  2004).  The  response  surface  typically  represents  unob-

cies  detectability  or  reporting  interest  (Fithian  et  al.,  2015;  Giraud 

served spatially smooth predictors. Using realistic simulated data, 

et  al.,  2016)  so  that  sampling  effort  represents  a  common  function 

we show that the method can alleviate bias in sampling effort and 

influencing in the same way the observation of multiple species.

species  niche  estimates  while  allowing  computational  efficiency 

Estimating  spatial  variation  in  sampling  effort  in  a  set  of  spe-

for large occurrence datasets. We further examined the method's 

cies occurrences is crucial for several purposes. An unknown spatial 

robustness to the approximation of constant sampling within cells 

variation  in  sampling  effort  can  be  correlated  to  an  environmental 

by varying the amplitude of spatial variation and the curvature of 

‚Ää1https://www.gbif.org/

the  sampling  effort  within  cells.  We  also  analysed  a  real  dataset 

including opportunistic occurrence data of plant species stemming 

BOTELLA ET AL.from automatic identification and sourced from the citizen science 

observatory Pl@ntNet. We present the results obtained for an ex-

otic invasive plant species in France.

2‚ÄÉ| ‚ÄÉM ATE R I A L S A N D M E TH O DS

2.1‚ÄÉ|‚ÄÉA spatial model for sampling effort

We jointly modelled the occurrence of multiple species as independ-

ent  marked  Poisson  point  processes.  In  this  model,  the  density  of 

each species occurrence process is the product of the sampling ef-

Methods in Ecology and Evolu(cid:13)on

‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ3

and  across  observers.  The  sampling  effort  at  point  z ‚àà D,  noted  s (z), 
represents the probability of observing a spatial point z. If a speci-
men is present at z, it is then detected and reported with probabil-
ity Ri,  which  implies  that  the  specimen  is  sampled  with  probability 
Ri s ( z ) ‚àà
. Although the probability of sampling species i  varies 
proportionally to s across space, it can be more or less detected than 

0, 1

[

]

other  species  overall.  The  distribution  of  observed  species  occur-

rence follows a thinned Poisson process, that is, a Poisson process 
of intensity z ‚Üí Ris ( z ) ùúÜi ( z ) (Chiu et al., 2013). A discussion of the as-
sumptions about the observation process is provided in Appendix G.

fort and of the given species density. Species density represents a 

2.1.3‚ÄÉ|‚ÄÉSpatial variation in sampling effort

spatial variation in relative abundance in function of environmental 

variables.  Figure  1  illustrates  the  principle  and  the  components  of 

We  model  s  as  a  cell- wise  constant  function  in  a  spatial  mesh  de-

the statistical model.

2.1.1‚ÄÉ|‚ÄÉSpecies occurrence processes and 
density functions

Let  D  be  a  two- dimensional  geographical  domain  where  occur-

rences  were  collected  for  N  species.  We  assume  that  individu-

als  of  any  species  i  are  distributed  over  D  according  to  a  Poisson 
process  depending  on  an  intensity  function ùúÜi. ùúÜi  is  assumed  to  be 
a  log- linear  function  of  environmental  variables  defined  across  D. 

xi
1

( z )

( z ) , ‚Ä¶, xi
pi

xi ( z ) =
  denote  the  environmental  features  of  spe-
cies  i  at  point  z,  where pi  is  the  number  of  features.  A  feature  can 
be  any  function  of  an  environmental  variable.  Different  features 

)

(

fined  over  D.  This  assumption  makes  sense  if  the  sampling  ef-

fort  is  known  to  vary  reasonably  slowly  across  space,  at  the  scale 

of  mesh  cells.  In  subsequent  analyses,  we  chose  a  mesh  with  rec-

tangular  cells  for  simplicity,  but  any  other  form  of  partition  of  D 

could be considered. The sampling effort is a factor in the intensity 

function  as  shown  in  Equation  2  of  Figure  1.  We  set,  at  any  point 

1,C

1.C

1,C
ÔøΩ

]  are  the  cells  of  the 

,  where (cj)j‚àà[
]ùõæ j1z‚ààcj
]cj = D,  and  ‚à©j‚àà[
ÔøΩ
ÔøΩ

z ‚àà D, s ( z ) = exp
j‚àà[
mesh  verifying  ‚à™j‚àà[
ÔøΩ‚àë
are the unknown sampling effort parameters. A parameter is defined 
)
in ‚Ñù for each unit of the spatial mesh. In other words, the sampling 
effort model associates a parameter to each cell indicator function, 
which  equals 1  in  the  cell  and  0  elsewhere.  We  can  only  estimate 

]cj = ‚àÖ,  and  ùõæ =

ùõæ 1, ‚Ä¶ ùõæ C

1,C

(

|

|

|

|

|

|

the  relative  sampling  effort  across  space,  and  thus  we  assume  by 
convention that ùõæ 1 = 0.

can  be  derived  from  the  same  variable:  for  instance,  if  we  include 

the  identity  and  quadratic  features,  we  model  a  Gaussian  density 

response to the environmental variable. ùõΩi =

1, ‚Ä¶, ùõΩi
ùõΩi
pi

 denote the 

2.1.4‚ÄÉ|‚ÄÉRelated methods

parameters associated with the features so that species intensity is 
pi
k = 1 ùõΩi
calculated  as  ùúÜi ( z ) = exp
estimate species density across space, not its absolute intensity, so 
we  assume  that ùõº1 = 0  by  convention.  In  addition,  the  model  does 
not estimate the overall intensity of one species relative to others, 

.  The  model  can  only 

ùõºi +

kxi

( z )

‚àë

ÔøΩ

ÔøΩ

k

)

(

Our method can be seen as a multi- species extension of the model 

of  Warton  et  al.  (2013),  apart  from  the  sampling  effort  design.  It  is 

also  a  particular  case  of  the  model  in  Fithian  et  al.  (2015),  in  which 

we  removed  the  presence‚Äì absence  term  (equation  10  in  Fithian 

as  this  cannot  be  differentiated  from  the  probability  of  detection/

et al., 2015) from the joint log- likelihood. Although we focus here on 

reporting  in  presence- only  data.  This  species  density  model  be-

presence- only  data,  data  integration  (Miller  et al., 2019)  is  probably 

longs  to  the  family  of  species  distribution  models  based  on  point 

the  best  strategy  to  correct  sampling  bias  when  more  standardized 

processes  (Chakraborty  et  al.,  2011;  Dorazio,  2014;  Fithian  et  al., 

data are also available (see Dorazio, 2014; Fithian et al., 2015; Giraud 

2015; Koshkina et al., 2017; Phillips et al., 2006; Renner et al., 2015; 

et al., 2016; Koshkina et al., 2017). A recent integrated data model es-

Warton et al., 2013).

pecially used a related random spatial surface model for the sampling 

effort based on a log- Gaussian Cox process (Simmonds et al., 2020).

2.1.2‚ÄÉ|‚ÄÉAssumption on the sampling effort process

The  model  defines  the  sampling  effort  as  a  spatial  function  repre-

senting  a  cumulated  number  of  visits  of  all  observers  at  a  particu-

lar point over a time period. This function is likely to vary at a high 

spatial resolution, but it makes sense to model it by a random func-

2.2‚ÄÉ|‚ÄÉModel identifiability and estimability

2.2.1‚ÄÉ|‚ÄÉIntensity is estimated up to an 
unknown factor

tion with some smooth spatial intensity. In addition, we assume that 

reporting  probability  for  a  given  species  is  constant  in  space,  time 

It is impossible to identify absolute values of Ri, the sampling ef-
fort s and the species density ùúÜi from presence- only data. We can 

BOTELLA ET AL. 
4‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇMethods in Ecology and Evolu(cid:13)on

F I G U R E   1 ‚ÄÉMethod workflow summary and statistical model

only  estimate  sampling  effort  and  species  density  up  to  a  factor 

that is constant across space (see Fithian & Hastie, 2013; Hastie 

2.2.2‚ÄÉ|‚ÄÉDisentangling sampling effort and species 
intensity parameters

& Fithian, 2013). For this reason, our approach allows estimating 

density variation across space, or relative intensity, but not abso-

Our method separates two spatial densities from a single distribu-

lute intensity.

tion  of  points,  and  it  is  important  to  ensure  that  the  parameters 

BOTELLA ET AL.Methods in Ecology and Evolu(cid:13)on

‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ5

of  these  densities  are  in  fact  estimable  (Jacquez  &  Greif,  1985). 

of  memory  and  computational  load,  given  the  structure  of  the 

Estimability relies on the orthogonality of the spatial covariates on 

model design matrix. The R code for reproducing the results and fit-

which the density components depend. As shown in Appendix B, if 

ting the model is provided in a publicly available Github repository 

the basis of spatial functions composed of environmental features 

(Botella, 2020).

and  sampling  cell  indicator  functions  is  close  to  multicollinearity, 

the true sampling effort and species density will be mixed together 

in the estimates. Such potential issue can be detected by assess-

2.4‚ÄÉ|‚ÄÉSimulation study

ing multicollinearity with the condition number, that is, the ratio of 

the highest over the lowest eigenvalues of the observed variance‚Äì 

We simulated occurrence data and tested the reliability of inferences 

covariance matrix of all model parameters. It is a common measure 

with our method. The R code to reproduce this simulation study, that 

for this purpose (see e.g. Dorazio, 2014). If the condition number 

is, to generate sampling effort rasters, to simulate species occurrences, 

is  high,  the  variance‚Äì covariance  matrix  exhibits  multicollinear-

to fit the model and to run the analysis over all scenarios, is provided in 

ity  and  high  covariance  between  the  parameter  estimates.  More 

the article code repository (Botella, 2020).

precisely,  given  that  there  is  no  collinearity  between  the  chosen 

environmental  features,  and  given  that,  by  design,  sampling  cell 

indicators have no multicollinearity, a high condition number nec-

2.4.1‚ÄÉ|‚ÄÉGeographical area

essarily  means  that  there  is  collinearity  between  environmental 

features  and  sampling  cell  indicators.  This  can  be  solved  by  in-

creasing the size of sampling cells until the condition number (al-
ways ‚â• 1) becomes reasonably small. In our experience, a condition 
number  inferior  to 106  was  still  reasonable  for  fitting  the  model. 
For a more detailed discussion of the issue, see Appendix B. The 

The  French  Mediterranean  region  was  used  as  a  reference  spatial 
domain D for simulation of species occurrences (over the longitude/

latitude extent [1.5, 8] √ó [41,45]).

observed  Fisher  information  matrix  is  provided  in  Appendix  A  to 

2.4.2‚ÄÉ|‚ÄÉSimulated species density

compute the condition number. An implementation in R language is 

provided in file Variance _ Script.r of the R package accompanying 

this article (Botella, 2020).

2.3‚ÄÉ|‚ÄÉParameter inference

We  summarize  here  the  procedure  for  inferring  parameter  values 

We  simulated  no = ( n1, ‚Ä¶, n50 )  occurrences  of  50  virtual  species 
over  D.  The  nis  were  chosen  from  real  occurrence  data  (i.e.  the 
50 most represented plant species in the Pl@ntNet queries data-

set;  Botella  et  al.,  2019).  This  resulted  in  the  following  statistics: 
min(no ) = 1502, max(no ) = 5002 and 
ini‚àï50 ‚âà 2206. All the virtual 
species  densities  (ùúÜi  for  species  i   in  our  model)  were  defined  as 
Gaussian functions of the same single environmental variable (two 

‚àë

from  multi- species  occurrence  data.  Appendix  D  further  includes 

cases considered: elevation/alti or annual precipitation/chbio_12, 

more explicit and detailed description of the procedure. A log- linear 

Poisson process is fitted over multiple species with a shared term in 

their linear predictor, that is, the log- sampling effort. The procedure 

minimizes the global negative log- likelihood in Equation 3, with re-

spect to the parameters. It is the sum of negative log- likelihoods over 

species Poisson processes.

log(p(Z1, ‚Ä¶, ZN

ùúÉ))

N

ni

=

i = 1 [
‚àë

k = 1
‚àë

log
|

s

zi
k

ùúÜi

zi
k

(

(

)

(

))

s(z)ùúÜi(z)dz

‚àí

‚à´D

.

]

see  Appendix  E).  The  expectation  of  the  Gaussian  density  was 
drawn  uniformly  inside  the  quantiles  0.1  and  0.9  of  the  environ-

mental variable range of values while the standard deviation was 
drawn  according  to  a  gamma  distribution  of  shape  parameter  3 
and  scale  parameter  50.  The  two  environmental  variables  were 

selected  because  they  are  both  strongly  linked  to  the  simulated 

sampling effort, and thus could challenge joint estimation of sam-

pling effort and species densities. In addition, the resolution of the 

(3)

alti  variable  (around  90  m)  was  much  finer  than  that  of  chbio_12 

(around  1  km),  and  alti  varied  more  within  sampling  cells  of  our 

model. Therefore, estimation bias was more likely to arise with alti 

This  objective  function  is  similar  to  the  one  in  Fithian  et  al. 

than with chbio_12.

(2015), yet without a presence‚Äì absence term (see Equation 14). To 

approximate the integrals, we sum over uniformly distributed back-

ground points (Warton et al., 2010), and use the re- expression as a 

2.4.3‚ÄÉ|‚ÄÉSampling effort

Poisson regression likelihood (Berman & Turner, 1992) to optimize it 

with standard generalized linear model software. Our implementa-

tion is based on the glmnet library, in R language. It is similar to the 

The  spatial  density  of  sampling  effort,  sH  was  parameterized 
by  a  bandwidth  parameter  H > 0,  which  controlled  the  level  of 

implementation  in  Renner  et  al.  (2015),  except  that  it  is  extended 

spatial  smoothness.  It  was  a  continuous  approximation  of  the 

to  a  multi- species  case  and  with  a  cell- wise  constant  sampling  ef-

fort.  glmnet  handles  sparse  matrices  and  is  very  efficient  in  terms 

density  of  real  occurrences,  obtained  by  filtering  the  Pl@ntNet 
dataset  (Botella  et  al.,  2019)  over  D.  More  precisely,  sH  was  an 

BOTELLA ET AL.6‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇMethods in Ecology and Evolu(cid:13)on

exponential  quadratic  kernel  density  estimator  (KDE)  func-

across  cells  as  explained  in  Appendix  D.  We  drew  these  points 

tion  applied  to  the  counts  of  those  occurrences  per  very  small  
square cells (resolution = 0.002 in longitude and latitude) over D. 
The  test  case  included  four  values  for  the  bandwidth  parameter 
H = {20, 50, 80, 100}  in  cell  units,  which  corresponded  to  3.2,  8, 

until there were at least 10 points per sampling cell. We fitted the 

model on data with different combinations of the environmental 

variables (elevation or precipitation) and sampling effort profiles 

(4 based on KDE with varying smoothness and the one constant 

12.8, 16  km in longitude, or 4.4, 11, 17.6, 22  km in latitude. The 
value  of  sH  at  point  z ‚àà D  was  a  weighted  average  of  the  occur-
rence counts of surrounding cells. The weight of a count of a cell at 
Euclidean distance d was proportional to exp(‚àín2/H). For instance, 
for H = 20, the weight decreased by 80% at 3.8  km in longitude. 
For the highest bandwidth H = 100, only large- scale demographic 

by cell).

2.4.6‚ÄÉ|‚ÄÉPerformance evaluation

We used two metrics to evaluate the estimation performance of the 

and  coastline  effects  were  visible  in  the  simulated  sampling  ef-
fort. For the lowest bandwidth H = 20, fine- grain effects such as 

sampling effort:

the influence of rivers or roads connecting cities were visible. In 

1.  The  coefficient  of  determination  between  the  simulated  sam-

addition to these KDE- based sampling efforts, we also considered 

pling  effort  and  its  estimation  over  the  points  of  a  fine  regular 

a  simulated  sampling  effort  assumed  to  be  constant  within  the 
cells of the mesh. This profile, called H=+Inf, was used as a refer-
ence and enabled an evaluation of the performance of the method 

spatial  grid  across  D  (approximately  200- m  resolution).

2.  The coefficient of determination between the simulated sampling 

effort averaged per sampling cell and its estimation over the same 

under the best model specification to characterize the error due 

points. In other words, this metric computes the correlation with 

to  estimation  variance.  The  sampling  effort  sharply  decreased, 

the best possible approximation of the true sampling effort and is 

on average, when the values of alti and chbio_12 increased. This 

necessarily superior to the first.

strong covariation in sampling effort and environmental variables 

would lead to bias in a naive SDM model (Ref?), which argues for 

the use of sampling bias correction. For computational details, the 

reader can refer to the script virtual_species_and_bias_final. R in 

the article repository (Botella, 2020).

We also evaluated the estimation performance of species i  den-
sity parameters as the coefficient of determination between ùúÜi and 
its estimate ÃÇùúÜi across uniformly distributed values of x in the range 
min
.  We  computed  the  metric 
over the environmental gradient  x rather than over the geographi-
[
cal space D, to avoid biasing the evaluation towards the most repre-

x ( z ) , z ‚àà D

x ( z ) , z ‚àà D

, max

}]

{

}

{

2.4.4‚ÄÉ|‚ÄÉSimulated species occurrences

sented environmental values.

‚ó¶ x, and for a given sam-
For a given species i  with spatial intensity ùúÜi
pling effort surface s, we independently simulated ni occurrences ac-
‚ó¶ x: D ‚Üí ‚Ñù +
cording to the conditional Poisson process of intensity sùúÜi
,  using  an  acceptation‚Äì rejection  algorithm  (Devroye,  1986).  To  do 
‚ó¶ x over D was determined. Then, it was 
this, the maximum M of sùúÜi
iterated  until  ni  points  were  obtained:  uniformly  drawing  a  point 
z ‚àà D,  drawing  a  random  variable  X ‚àº U ( [ 0, M ] ),  accepting  z  if 
‚ó¶ x ( z ) or rejecting it otherwise. This procedure was con-
X ‚â§ s ( z ) ùúÜi
sistent with our distribution and observation model as described in 

Figure 1.

2.4.5‚ÄÉ|‚ÄÉModel fitting

2.5‚ÄÉ|‚ÄÉApplication to a real dataset

We  also  fitted  the  model  to  real  occurrences  recorded  in  the  Pl@

ntNet  query  dataset  (Botella  et  al.  2019).  The  occurrences  in  this 

dataset  were  collected  by  citizens  using  the  Pl@ntNet  mobile  ap-

plication  (Joly  et  al.,  2016).  They  were  automatically  identified  by 

the Pl@ntNet AI engine. Details on the identification system and the 

database infrastructure of Pl@ntNet are provided in Affouard et al. 

(2017). The dataset is publicly available on the open- access reposi-

tory  Zenodo  (http://doi.org/10.5281/zenodo.2634137).  The  code 

for  extracting  occurrence  and  environmental  data  and  fitting  the 

model is provided in the code repository accompanying this article 

(Botella, 2020).

We fitted the model for the 50 species with a spatial mesh of rec-

tangular  cells  with  (0.1,  0.1)  dimensions  in  (longitude,  latitude), 

or  approximately  (8,  11)  in  kilometres.  Thus,  except  for  the  case 

2.5.1‚ÄÉ|‚ÄÉSpecies occurrences

where  the  simulated  sampling  effort  was  constant  cell- wise,  the 

fitted model was deliberately misspecified. Indeed, the simulated 

We  selected  species  occurrence  records  in  France  from  the  be-

sampling  effort  varied  strongly  within  cells  for  the  lowest  band-
width  H = 20,  and  much  more  weakly  for  the  highest  H = 100. 
After  defining  the  mesh,  only  cells  with  at  least 50  occurrences 

ginning  of  2017  to  October  2018.  The  process  involved  a  user  of 

the  Pl@ntNet  mobile  application  taking  one  or  several  pictures  of 

parts of a plant specimen (e.g. leaf, flower, fruit, bark, etc.). The pic-

were used to fit the model. We drew background points uniformly 

tures were then sent to the Pl@ntNet server to carry out automatic 

BOTELLA ET AL.Methods in Ecology and Evolu(cid:13)on

‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ7

identification of the species and produce a probability distribution 

of  the  linear  predictor  of  any  species  density,  with  12  feature 

across species. The highest of these probabilities was then the iden-

terms  computed  from  the  environmental  variables  of  Table  1  of 

tification confidence score. We only kept species occurrences whose 

confidence score (field FirstResPLv2Score) was above 0.85. We also 

removed all occurrences with missing values for the selected envi-

ronmental variables (described below). In the last step, we kept only 

the 150 species with the highest number of occurrences. The list of 

species is provided in the table speciesTable.csv on the article code 

Appendix E. This resulted in 13 parameters for each species den-
sity,  including  the  intercept,  plus  2, 869 ‚àí 1  observation  param-
eters in sampling cells, resulting in 4, 817 parameters in total, for 
302, 961 occurrences.

‚àº 1 + etp + I(etp2) + I(chbio_12 ‚àí etp) + I((chbio_12 ‚àí etp)2)

repository (Botella, 2020). The mesh used for our model was defined 

+chbio_1 + I(chbio_12) + chbio_5 + I(chbio_52) + awc_top

as a regular spatial grid of 8- km- wide squares over France, including 

+I(awc_top2) + bs_top + I(bs_top2).

(4)

Corsica, which we restricted to squares whose centre was inside the 

territory  or  closer  than  4  km  to  the  border  or  coast.  Only  squares 

2.5.4‚ÄÉ|‚ÄÉBackground points

with more than 30 occurrences were used to fit the model: occur-

rences within other squares were excluded. This resulted in a set of 

We  uniformly  drew  a  fixed  number  of  points  per  sampling  cell  as 

302,961 occurrences, distributed over 2,869 spatial squares cover-

described  in  Appendix  D.  This  avoided  the  problems  of  total  uni-

ing around 15% of the French territory. These squares are coloured 

form sampling, that is, cells with no background points. We drew 15 

on the map in Figure 3. To illustrate the method output for species 

points per sampling cell to account for environmental heterogeneity 

density, we compared the fitted density of Phytolacca americana L., 

within cells, which resulted in around 43,000 background points du-

an exotic invasive plant species in France, to externally available dis-

plicated for each species, or 6,450,000 background points in total. 

tribution data. For this comparison, we referred to the occurrences 

The  dimensions  of  the  model  design  matrix  were  then  (6,752,961; 

recorded  by  the  Federation  of  National  Botanical  Conservatories 

4,817). A standard R numerical matrix with these dimensions would 

(FCBN),  geographically  summarized  at  http://siflo re.fcbn.fr/?cd_

ref=&r=metro,  and  to  occurrences  listed  in  Dumas  (2011)  and  
Pl@ntNet.

require around 231 GBytes of RAM memory. However, as our design 
matrix is sparse, with only 2 ‚àó ( pi + 1 ) + 1 = 27 non- null values per 
row, its storage cost was divided by a factor of around 180 with the 

R sparse matrix format (see library Matrix). Consequently, we could 

fit this model on a laptop with R- glmnet (it requires about 20 Gbytes 

2.5.2‚ÄÉ|‚ÄÉEnvironmental data

of RAM overall).

A set of nine environmental variables was used to model the envi-

ronmental  density  of  species.  These  were  selected  carefully  to 

3‚ÄÉ| ‚ÄÉR E S U LT S

model the macroecological niche of plant species, following the rec-

ommendations in Mod et al. (2016). The set included mean and an-

The simulation study allowed us to evaluate the reliability of our joint 

nual 

temperature  variation,  annual  precipitation,  potential 

model  estimation  method  (see  Section  2.4).  The  two  performance 

evapotranspiration, available soil water capacity and a soil pH proxy. 

metrics  obtained  for  the  10  simulation  scenarios  (2  environmental 

The  variables  are  presented  in  Table  1  of  Appendix  E.  We  got  the 

variables and 5 sampling effort profiles) are summarized in Figure 2. 

environmental  data  from  multiple  sources  (Karger  et  al.,  2016; 

We were also able to illustrate the effectiveness of the method on 

Panagos,  2006;  Panagos  et  al.,  2012;  Van  Liedekerke  et  al.,  2006; 

the Pl@ntNet queries dataset as described in Section 2.5. The esti-

Zomer  et  al.,  2007,  2008).  We  extracted  the  values  at  occurrence 

mated sampling effort is displayed in Figure 3. The estimation results 

points from the geographical rasters described and downloadable at 
Botella (2019).2

for an exotic invasive plant, Phytolacca americana L, are provided in 

Figure 4.

2.5.3‚ÄÉ|‚ÄÉSpecies density model

We  modelled  the  distribution  of  species  along  continuous  en-

vironmental  gradients  with  a  Gaussian  density  function.  We 

combined annual rainfall chbio_12 and potential evapotranspira-

tion  etp  into  chbio_12- etp,  known  as  the  water  balance,  which 

is commonly used in plant SDM (Mod et al., 2016). We included 

pedologic  variables  representing  categories  of  physicochemi-

cal  properties.  To  summarize,  Equation  (4)  shows  the  R  formula 

‚Ää2http://doi.org/10.5281/zenodo.2635501

3.1‚ÄÉ|‚ÄÉSimulation: Very good fit when the simulated 
sampling effort was cell- wise constant

The  estimated  sampling  effort  had  an  R2  of  0.97  (for  both  alti  and 
chbio_12)  compared  to  the  simulated  sampling  effort  when  the  lat-
ter  was  constant  within  cells  (columns  x:alti  H=+Inf  and  x:chbio12 
H=+Inf of Figure 2a). This means that the estimate was almost col-
linear  with  the  true  sampling  effort.  Regarding  species  density  esti-
mates, the average R2 over all species was 0.95 for alti and 0.88 for 
chbio_12 (columns x:alti H=+Inf and x:chbio12 H=+Inf of Figure 2b). 
This  shows  that  the  method  recovers  unbiased  niches  and  sampling 

BOTELLA ET AL.8‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇMethods in Ecology and Evolu(cid:13)on

 was computed 

 between generative 

F I G U R E   2 ‚ÄÉR2
and estimated model components in the 
10 simulation scenarios for the sampling 
effort (a) and the species environmental 
density (b). In (a), the R2
between the simulated sampling 
effort density (raw in red or averaged 
per estimation cell in black) and the 
estimated density over the geographical 
space. Regarding the evaluation of the 
species density estimates, the same 
metric was computed between the true 
and the estimated density across the 
environmental gradient and for the 50 
species, for each scenario. In (b), the 50 
species metrics values are summarized 
through boxplots overlaid on a density 
plot

F I G U R E   3 ‚ÄÉRelative sampling effort 
estimated from occurrences recorded 
in Pl@ntNet in France. The model was 
fitted on 302,961 occurrences of 150 
plant species in France reported between 
2017 and 2018 using the Pl@ntNet 
application. We represent the estimated 
sampling effort in the logarithm with base 
10 to more clearly shows the orders of 
variation. The white cells are those with 
too few occurrences to be integrated in 
the model

effort  estimates  under  good  model  specifications  (sampling  effort 

However, in reality, sampling effort is not constant within cells, so the 

constant  within  cells)  and  that  it  is  almost  unaffected  by  estimation 

effect  of  violating  this  assumption  also  needed  to  be  assessed,  as 

variance with this realistic simulated sample size and parameterization. 

shown below.

BOTELLA ET AL.Methods in Ecology and Evolu(cid:13)on

‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ9

F I G U R E   4 ‚ÄÉRaw occurrence and 
estimated density of Phytolacca americana 
L. from Pl@ntNet data. (a) 4,640 
occurrences of Phytolacca americana 
L. recorded by Pl@ntNet users with 
automatic identification over the 2017‚Äì 
2018 period. (b) Decimal logarithm of 
predicted relative density of Phytolacca 
americana L. across France estimated  
from the occurrences with the proposed 
study method. The discrete gradient 
of colours represents quantile interval 
ranges

3.2‚ÄÉ|‚ÄÉSimulation: Smoother is better

3.3‚ÄÉ|‚ÄÉBias under joint variation in sampling 
effort and environmental variables within cells

The red and black curves of Figure 2a show that the approximation 

of  the  sampling  effort  was  better  when  the  sampling  effort  was 

The high error of x:alti H:20 cannot be due to estimation variance, 

smoother, for both environmental variables. While the red curve 

as the fit was almost perfect for the cell- wise constant effort. The 

represents the fit of the raw sampling effort, the black curve rep-

error was most likely due to an estimation bias when the model 

resents  the  fit  of  the  sampling  effort  averaged  per  cell  (i.e.  the 

of sampling effort cannot fit the variation in occurrence density 

best cell- wise constant approximation (BCCA) of the true sampling 

within cells. To explain it in the simplified context of a single spe-

effort that can be estimated by the model in the ideal case) and is 
always  above  the  red  curve.  As H  increased,  the  sampling  effort 

variation  within  cells  became  smoother,  that  is,  the  curvature  of 

the  spatial  function  decreased,  and  was  thus  closer  to  constant 

within cells. This tended to reduce the gap between the red and 

black curves when H increased and the model converged towards 

the  BCCA.  However,  it  is  surprising  that  for  x:alti  H:20  the  gap 

between  the  red  and  the  black  curve  was  much  smaller  than  for 
x:alti H:50 (R2 = 0.0044 for the true sampling effort and R2 = 0.01 
for the BCCA).

cies case, the model is optimized so that variation in occurrence 
‚ó¶ x ( z )  (product  of  the  sampling  effort  and  the 
intensity  sùõæ ( z ) ùúÜùõΩ
species  density  estimates)  fits  the  variation  in  observed  occur-
rence density s ( z ) ùúÜ ‚ó¶ x ( z ) across space. However, the best approx-
imation of this product of densities is not necessarily the product 
of  the  best  approximations  per  density,  namely  the  BCCA  of  s 
and ùúÜ ‚ó¶ x itself. More precisely, bias may appear if sampling effort 
strongly and monotonically varies with the environmental feature 

x  within  cells.  We  visualize  and  describe  such  bias  in  sampling 

effort  profile  (3)  in  the  complementary  simulation  experiment 

BOTELLA ET AL.10‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇMethods in Ecology and Evolu(cid:13)on

in Appendix F, with a joint visualization of species and sampling 

of  the  Phytolacca  habitat  as  described  in  Dumas  (2011).  This  spe-

effort  density  estimates.  The  examination  of  a  re- expression  of 

cies  is  cultivated  as  an  ornamental  shrub  all  over  France‚Äî one  of 

the  asymptotic  model  likelihood  (Equation  3,  second  subsection 

the reasons for its introduction‚Äî and often becomes established on 

of  Appendix  B)  suggested  that,  if  bias  happens,  the  N  species 
density  parameters  ùõΩ1, ‚Ä¶, ùõΩN  controlling  the  log- linear  response 
of  the  species  densities ùúÜ1, ‚Ä¶, ùúÜN  to  x  are  all  likely  to  be  biased. 

disturbed soils in surrounding areas. In rural areas, it prefers man-

aged  forests  with  acidic,  sandy  soils.  It  is  also  found  along  rivers 

bordered with trees, as predicted by the model along the Rhone and 

Their  errors  should  have  the  same  sign,  to  compensate  for  the 

the Garonne. Northern France is not favourable to this species. The 

increase or decrease in sampling effort along the environmental 

model  identified  true  hotspots  even  in  scarcely  sampled  areas.  It 

feature within cells. This bias is related to the problem of spatial 

also predicted that the species is abundant in several relatively un-

confounding in spatial statistics (Hodges & Reich, 2010).

sampled departments, such as the Indre, Aude, Charente and Gers. 

3.4‚ÄÉ|‚ÄÉSimulation: Estimation of species density 
improved with smoother sampling effort

Figure 2b shows that species responses using the model were, on 

Indeed,  Figure  3,  representing  the  fitted  log- relative  sampling  ef-

fort, shows that most cells in those regions had too few occurrences 

to be included in the model, and the ones that were included had a 

relatively low sampling effort. The FCBN records from 2000, which 

can be seen at http://siflo re.fcbn.fr/?cd_ref=113418 r = metro, con-
firm that the species is indeed widely present in Indre. Conversely, 

average, well estimated in most scenarios, even when sampling ef-

there  are  very  few  reports  in  the  National  Inventory  of  Natural 

fort estimation was worst. In the scenario x:alti H:20, the average 
R2 of the 50 species densities was around 0.85. In fact, as shown by 

Assets (INPN) data for Aude, Charente or Gers, although presence- 

only records exist (Dumas, 2011 and Pl@ntNet). Those regions have 

the asymmetry of density plots in all scenarios, most species had 

been undersurveyed by conservatory experts in the last 20 years. 

a good fit with similar performance while a few had a significantly 

Thus, the current estimated abundance of Phytolacca americana has 

worse  fit.  As  for  the  estimation  of  sampling  effort,  quality  nota-

either  stayed  undetected  by  sampling  or  is  the  result  of  a  recent 

bly increased with H. This indicates that the robustness issue with 

invasion.

sampling  effort  variation  within  cells  translated  into  bias  in  spe-

cies estimates. In addition, some species were consistently badly 
estimated,  with  R2  below  0.50  even  for  H = + Inf.  This  could  be 

the consequence of a simulated niche optimum being in a scarcely 

4‚ÄÉ| ‚ÄÉD I S CU S S I O N

sampled  area  and/or  a  lack  of  occurrences.  Species  density  esti-

We found that our method to jointly estimate densities of multiple 

mation was, overall, worse for chbio_12 than alti, even with good 
model  specification  (0.88  for  x:chbio_12 H:+Inf  on  average  com-
pared to 0.95 for x:alti H:+Inf on average, see Figure 2b), whereas 
the estimation of sampling effort density was almost perfect. This 

species,  with  a  spatial  function  representing  a  common  sampling 

effort, provides unbiased estimation of species relative density and 

sampling  effort  if  the  latter  is  constant  within  the  cells  of  a  spa-

tial mesh. This allows the flexible estimation of the sampling effort, 

implies  that  lower  performance  was  not  due  to  estimation  bias, 

with no other prior knowledge than the grain of its spatial variation. 

but to estimation variance, due to responses that were harder to 

Although  the  condition  of  constant  sampling  effort  within  cells  is 

estimate  given  the  sampling  effort  and  occurrences.  The  lower 

crucial  to  disentangle  species  and  sampling  densities,  the  method 

estimation  quality  with  chbio_12  was  thus  not  intrinsically  due 

is  robust  for  reasonable  variation  of  sampling  effort  within  cells, 

to the variable itself, but a consequence of species niches (which 

and even to stronger variation unrelated to environmental drivers 

were randomly defined) that are harder to estimate. It also high-

of species density. We also found that the information gain on sam-

lights that even when species estimation is unbiased, its precision 

pling  effort  from  the  most  observed  species  helps  to  better  esti-

necessarily depends on the overall intensity of sampling, that is, a 

mate the niche of less observed species (Appendix C). Our method 

sufficient  number  of  points  are  required  everywhere  (all  species 

is devised for analysing large volumes of occurrences. Nevertheless, 

included)  in  environmental  space  to  ensure  homogeneity  in  the 

the simulation experiments and complementary results (Appendix 

estimation quality across species, as highlighted in section model 

F) showed that the artefactual influence of an environmental fea-

design guidelines.

3.5‚ÄÉ|‚ÄÉApplication: Phytolacca americana L. 
distribution

ture on species density can bias estimates when the sampling effort 

model  is  misspecified.  More  precisely,  such  bias  appears  along  an 

environmental feature gradient if the true sampling effort strongly 

and monotonically covaries with this feature within cells (Appendix 

B). Removing this variable from the model of a species known to not 

respond to it should eliminate this bias for all species.

Using the Pl@ntNet queries dataset, we fit the model to provide spe-

In the context of the model's application to Pl@ntNet data, we fit 

cies density estimates for 150 plant species. Figure 4b displays the 

the model on a total of 302,961 citizen science occurrences of 150 

decimal logarithm density estimation of Phytolacca americana L. The 

plant  species,  covering  15%  of  France  partitioned  into  2,869  sam-

estimation provided by the model is consistent with the knowledge 

pling cells. The estimated density of Phytolacca americana L. suggests 

BOTELLA ET AL.Methods in Ecology and Evolu(cid:13)on

‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ11

potential invaded areas yet undetected in published data, especially 

variance (see the first point above), the identifiability (discussed 

in  scarcely  sampled  regions.  Nevertheless,  predictions  out  of  the 

in Section 2.2) and the memory limitation (number of background 

training area must be carefully examined, as they may present differ-

points required). Conversely, designing cells that are too large re-

ent environmental conditions and be subject to extrapolation errors.

sults in more variation in sampling effort within cells, which tends 

4.1‚ÄÉ|‚ÄÉMethod use guidelines

to  favour  estimation  bias  (see  Section  3  and  Appendix  B,  para-

graph 2). In practice, a cross- validation scheme should be run for 

each tested cell area. Decreasing the size of cells can very quickly 

increase  the  estimation  variance  in  the  species  parameters,  as 

This method should be useful for large datasets of opportunistic oc-

shown for a simulation example in paragraph 4 of Appendix C.

currences in which some species are highly observed: for instance, 

5.  It  is  important  to  include  some  species  with  many  occurrences 

with data from large citizen science or naturalist programmes. The 

in the model if available, especially if they are generalist respec-

recommendations on model design and sample size below indicate 

tive to the environmental features. As shown in Appendix C, an 

the conditions under which the method is most potentially useful:

increase in the number of occurrences of a single species reduces 

the estimation variance in sampling effort, which, in turn, reduces 

1.  Include  at  least  several  tens  of  occurrences  (all  species  included) 

estimation  variance  in  all  other  species  parameters.  Moreover, 

per  sampling  cell.  Otherwise  discard  the  cells  and  their  occur-

species  with  many  occurrences  contribute  more  to  estimation 

rences, and do not include any background points over these cells. 

variance  as  they  are  widely  distributed  in  the  environmental 

Alternatively,  the  user  can  increase  the  size  of  cells  or  include 

space.

more  species,  widely  distributed  and  with  many  occurrences, 

6.  An environmental variable should be removed from the model of 

to  meet  the  condition.  Indeed,  the  information  gain  on  the 

a species if the species is known to be generalist along this gra-

sampling  effort  parameter  in  a  cell  is  equal  to  the  total  number 

dient. This (a) reduces the estimation variance for all other spe-

of  occurrences  in  this  cell  (see  Appendix  A).  Scarce  cells  are  a 

cies density parameters associated with this gradient, as shown in 

useless  computational  burden,  as  they  need  background  points, 

paragraphs 2 and 3 of Appendix C and (b) drastically reduces the 

and  a  potential  source  of  variance.  As  the  sampling  effort  in 

estimation bias. Indeed, generalist species clarified in this way in 

those  cells  is  very  uncertain,  they  consume  degrees  of  liberty 

the model provide a reference for sampling effort along the envi-

but  do  not  contribute  to  reducing  the  variance  in  the  species 

ronmental gradient for the model.

parameters.  The  method  is  not  suited  to  contexts  where  the 

concentration  of  occurrences  per  sampling  cell  is  too  low:  for 

example,  herbarium  datasets  with  few  samples  collected  over 

4.2‚ÄÉ|‚ÄÉScalability

large  areas  with  very  heterogeneous  sampling  effort.  In  such 

cases, the FactorBiasOut/TGB method (Phillips et al., 2009) should 

This  method  can  handle  datasets  that  include  a  massive  number 

be  more  reliable  because  it  does  not  require  many  degrees  of 

of total occurrences over large geographical areas with many sam-

freedom  to  model  sampling  effort.  For  example,  our  test  case 

pling cells, as shown by our test case with the Pl@ntNet data across 

had  an  average  of  105  occurrences  per  cell.

France.  This  is  favoured  by  the  cell- wise  constant  sampling  effort 

2.  There should be at least several tens of occurrences for each en-

model and the use of a sparse design matrix. The memory load in-

vironmental feature for each species. This is because the informa-

creases sublinearly with the number of sampling cells, but is roughly 

tion  gained  on  the  parameters  of  a  species  comes  only  from  its 
intensity of occurrence sùúÜi ‚ó¶ x as can be seen in the expression of 
I ( ùõΩi ) given in Appendix A, because ùîº ( ni ) = ‚à´D.

proportional to the inverse cell area of the highest resolution envi-

ronmental raster. While there must be background points in all sam-

pling cells, their total number just needs to enable a good screening 

3.  For  each  environmental  feature,  the  standard  deviation  of  this 

of the overall environmental variability. The number of species may 

feature  over  all  occurrences  divided  by  the  standard  deviation 

also be limiting as this linearly increases the memory load, indepen-

over  background  points  should  not  be  too  small  (at  least  1/3  in 

dently of their number of occurrences. There is a room for improve-

practice). This is a proxy of the spread of the overall occurrence 

ment in reducing the need for memory in the fitting procedure: for 

intensity along the feature gradient. The estimation of this param-

instance, by optimizing the selection of background points or using a 

eter  with  a  certain  confidence  will  require  more  occurrences  if 
this indicator is low. Indeed, I ( ùõΩi
k ) = ‚à´Ds ( z ) xk ( z ) 2ùúÜi ( x ( z ) ) dz thus, 
if  x is centred, the information on the species parameter is pro-

batch gradient descent algorithm.

portional to a (spatially weighted) variance in the corresponding 

5‚ÄÉ| ‚ÄÉCO N C LU S I O N S

environmental feature across space.

4.  Regarding the choice of cell size, an optimal compromise should 

Our results demonstrate that our method can estimate sampling ef-

exist,  but  we  have  no  definite  procedure  to  reach  it  yet.  Three 

fort from presence- only data in a geographical space with consider-

main  limitations  can  prevent  good  estimation  when  the  sam-

ably  fewer  prior  assumptions  than  previous  methods.  The  method 

pling  mesh  reaches  a  resolution  that  is  too  high:  the  estimation 

can be extended to allow its use in a broad range of situations. It is 

BOTELLA ET AL.12‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇMethods in Ecology and Evolu(cid:13)on

especially suited to analyse massive occurrences of multiple species 

at a large spatial scale, and should decrease bias in species distribu-

tion estimates. We thus think the approach will be useful to recover 

information  about  sampling  effort  from  purely  opportunistic  oc-

currence data, enabling post- analysis of sampling effort variation in 

citizen  science  programmes  and  guiding  strategies  for  further  data 

collection. Insofar as citizen science data can provide time series over 

a long enough period, our method should allow monitoring of remark-

able  or  noxious  species  such  as  exotic  invasive  species  and  help  to 

guide conservation and management strategies (Botella et al., 2018).

AC K N OW L E D G E M E N T S

The authors would like to thank the consortium Floris'Tic, the GDR 

CNRS  3645  ‚ÄòEcologie  Statistique‚Äô,  the  CiSStats  network‚Äî Statistics 

for Citizen Sciences‚Äî and the ANR project EcoNet who all supported 

this  work.  The  authors  also  thank  the  anonymous  associate  editor 

for its investment and deep remarks all along the reviewing process. 

Finally, the authors would like to thank Gilles Le Moguedec for his 

contribution  to  this  work  and  general  support  during  the  Phd  of 

Christophe BOTELLA.

AU T H O R S '  C O N T R I B U T I O N S

All authors conceived and designed the methodology; A.J. and P.B. 

provided  the  Pl@ntNet  data;  C.B.  compiled  and  published  all  the 

data,  carried  out  the  mathematical  analysis,  developed  the  code, 

performed the data analysis and led the writing of the manuscript. 

All authors contributed critically to the drafts and gave final approval 

for publication.

DATA  AVA I L A B I L I T Y S TAT E M E N T

Following the FAIR principles, the datasets and source code used in 

this manuscript are provided at the URLS below:

‚Ä¢  Species occurrence data may be freely downloaded at http://doi.

org/10.5281/zenodo.2634137 (Botella et al., 2019).

‚Ä¢  Environmental  rasters  may  be  freely  downloaded  at  http://doi.

org/10.5281/zenodo.2635501 (Botella, 2019).

‚Ä¢  The  R  code  for  running  simulations  and  real  data  illustration,  as 

well  as  the  list  of  modeled  species  are  provided  on  the  manu-

script dedicated Github repository https://doi.org/10.5281/ zenodo. 

4455857 (Botella, 2020).

O R C I D

Christophe Botella 

 https://orcid.org/0000-0002-5249-911X 

Alexis Joly 

 https://orcid.org/0000-0002-2161-9940 

Pierre Bonnet 

 https://orcid.org/0000-0002-2828-4389 

Fran√ßois Munoz 

 https://orcid.org/0000-0001-8776-4705 

Pascal Monestiez 

 https://orcid.org/0000-0001-5851-2699 

R E F E R E N C E S

Affouard,  A.,  Go√´au,  H.,  Bonnet,  P.,  Lombardo,  J.  C.,  &  Joly,  A.  (2017). 
Toulon:  s.n.,  6  p.  Pl@ntNet  app  in  the  era  of  deep  learning.  ICLR: 
International  Conference  on  Learning  Representations.  5,  Toulon, 

France, 24 Avril 2017/26 Avril 2017. Retrieved from https://hal.archi 
ves- ouver tes.fr/hal- 01629195

Beck, J., B√∂ller, M., Erhardt, A., & Schwanghart, W. (2014). Spatial bias 
in the gbif database and its effect on modeling species' geographic 
distributions. Ecological Informatics, 19, 10‚Äì 15.

Berman,  M.,  &  Turner,  T.  R.  (1992).  Approximating  point  process  like-
lihoods with glim. Applied Statistics, 31‚Äì 38. https://doi.org/10.2307/ 
2347614

Boakes, E. H., McGowan, P. J., Fuller, R. A., Chang- qing, D., Clark, N. E., 
O'Connor, K., & Mace, G. M. (2010). Distorted views of biodiversity: 
Spatial  and  temporal  bias  in  species  occurrence  data.  PLoS  Biology, 
8(6), e1000385.

Botella, C. (2019). A compilation of environmental geographic rasters for 
sdm  covering  france  (version  1).  Zenodo,  https://doi.org/10.5281/
zenodo.2635501

Botella, C. (2020). R code repository for ‚Äòjointly estimating spatial sam-
pling effort and habitat suitability for multiple species from oppor-
tunistic occurrence data‚Äô. https://doi.org/10.5281/zenodo.4455857
Botella, C., Bonnet, P., Joly, A., Lombardo, J.- C., & Affouard, A. (2019). Pl@
ntnet queries 2017‚Äì 2018 in france. Zenodo, https://doi.org/10.5281/
zenodo.2634137

Botella, C., Joly, A., Bonnet, P., Monestiez, P., & Munoz, F. (2018). Species 
distribution modeling based on the automated identification of citi-
zen observations. Applications in Plant Sciences, 6(2), e1029.

Botella, C., Joly, A., Monestiez, P., Bonnet, P., & Munoz, F. (2020). Bias 
in  presence- only  niche  models  related  to  sampling  effort  and  spe-
cies niches: Lessons for background point selection. PLoS One, 15(5), 
e0232078.

Bradter, U., Mair, L., J√∂nsson, M., Knape, J., Singer, A., & Sn√§ll, T. (2018). 
Can  opportunistically  collected  citizen  science  data  fill  a  data  gap 
for  habitat  suitability  models  of  less  common  species?  Methods  in 
Ecology  and  Evolution,  9(7),  1667‚Äì 1678.  https://doi.org/10.1111/ 
2041- 210X.13012

Bystriakova, N., Peregrym, M., Erkens, R. H., Bezsmertna, O., & Schneider, 
H. (2012). Sampling bias in geographic and environmental space and 
its  effect  on  the  predictive  power  of  species  distribution  models. 
Systematics and Biodiversity, 10(3), 305‚Äì 315.

Calenge, C., Chadoeuf, J., Giraud, C., Huet, S., Julliard, R., Monestiez, P., 
Piffady, J., Pinaud, D., & Ruette, S. (2015). The spatial distribution of 
mustelidae in France. PLoS One, 10(3), e0121689.

Chakraborty, A., Gelfand, A. E., Wilson, A. M., Latimer, A. M., & Silander, 
J.  A.  (2011).  Point  pattern  modelling  for  degraded  presence- only 
data over large regions. Journal of the Royal Statistical Society: Series C 
(Applied Statistics), 60(5), 757‚Äì 776.

Chandler, M., See, L., Copas, K., Bonde, A. M., L√≥pez, B. C., Danielsen, 
F.,  Legind,  J.  K.,  Masinde,  S.,  Miller- Rushing,  A.  J.,  Newman,  G.,  & 
Rosemartin,  A.  (2017).  Contribution  of  citizen  science  towards  in-
ternational  biodiversity  monitoring.  Biological  Conservation,  213, 
280‚Äì 294.

Chiu, S. N., Stoyan, D., Kendall, W. S., & Mecke, J. (2013). Stochastic geom-

etry and its applications. John Wiley & Sons.

Costa, G. C., Nogueira, C., Machado, R. B., & Colli, G. R. (2010). Sampling 
bias and the use of ecological niche modeling in conservation plan-
ning:  A  field  evaluation  in  a  biodiversity  hotspot.  Biodiversity  and 
Conservation, 19(3), 883‚Äì 899.

De Solan, T., Renner, I., Cheylan, M., Geniez, P., & Barnagaud, J.- Y. (2019). 
Opportunistic records reveal mediterranean reptiles‚Äô scale- dependent 
responses to anthropogenic land use. Ecography, 42(3), 608‚Äì 620.
Devroye, L. (1986). Sample- based non- uniform random variate genera-
tion. In WSC '86: Proceedings of the 18th conference on Winter simula-
tion, December 1986, pp. 260‚Äì 265. https://doi.org/10.1145/318242. 
318443

Dorazio,  R.  M.  (2014).  Accounting  for  imperfect  detection  and  survey 
bias in statistical analysis of presence- only data. Global Ecology and 
Biogeography, 23(12), 1472‚Äì 1484.

BOTELLA ET AL.Methods in Ecology and Evolu(cid:13)on

‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ13

Dumas,  Y.  (2011).  Que  savons- nous  du  raisin  d‚Äôam√©rique  (Phytolacca 
americana), esp√®ce exotique envahissante? synth√®se bibliographique. 
Rendez- vous Techniques ONF, 2011, 48‚Äì 57.

Panagos,  P.,  Van  Liedekerke,  M.,  Jones,  A.,  &  Montanarella,  L.  (2012). 
European soil data centre: Response to european policy support and 
public data requirements. Land Use Policy, 29(2), 329‚Äì 338.

Elith, J., & Leathwick, J. R. (2009). Species distribution models: Ecological 
explanation and prediction across space and time. Annual Review of 
Ecology, Evolution, and Systematics, 40, 677‚Äì 697.

Phillips, S. J., Anderson, R. P., & Schapire, R. E. (2006). Maximum entropy 
modeling  of  species  geographic  distributions.  Ecological  Modelling, 
190(3), 231‚Äì 259.

Fithian, W., Elith, J., Hastie, T., & Keith, D. A. (2015). Bias correction in 
species  distribution  models:  Pooling  survey  and  collection  data  for 
multiple species. Methods in Ecology and Evolution, 6(4), 424‚Äì 438.
Fithian, W., & Hastie, T. (2013). Finite- sample equivalence in statistical 
models for presence- only data. The Annals of Applied Statistics, 7(4), 
1917.

Giraud,  C.,  Calenge,  C.,  Coron,  C.,  &  Julliard,  R.  (2016).  Capitalizing  on 
opportunistic  data  for  monitoring  relative  abundances  of  species. 
Biometrics, 72(2), 649‚Äì 658.

Hastie, T., & Fithian, W. (2013). Inference from presence- only data; The 

ongoing controversy. Ecography, 36(8), 864‚Äì 867.

Hodges, J. S., & Reich, B. J. (2010). Adding spatially- correlated errors can 
mess  up  the  fixed  effect  you  love.  The  American  Statistician,  64(4), 
325‚Äì 334.

Jacquez, J. A., & Greif, P. (1985). Numerical parameter identifiability and 
estimability: Integrating identifiability, estimability, and optimal sam-
pling design. Mathematical Biosciences, 77(1‚Äì 2), 201‚Äì 227.

Johannesson,  G.,  &  Cressie,  N.  (2004).  Finding  large- scale  spatial 
trends  in  massive,  global,  environmental  datasets.  Environmetrics: 
The Official Journal of the International Environmetrics Society, 15(1),  
1‚Äì 44.

Joly,  A.,  Bonnet,  P.,  Go√´au,  H.,  Barbe,  J.,  Selmi,  S.,  Champ,  J.,  Dufour- 
Kowalski,  S.,  Affouard,  A.,  Carr√©,  J.,  Molino,  J.- F.,  &  Boujemaa,  N. 
(2016). A look inside the pl@ ntnet experience. Multimedia Systems, 
22(6), 751‚Äì 766.

Joly, A., Go√´au, H., Botella, C., Glotin, H., Bonnet, P., Vellinga, W. P., Planqu√©, 
R., & M√ºller, H. (2018). Overview of lifeclef 2018: a large- scale evalua-
tion of species identification and recommendation algorithms in the era 
of ai. In International Conference of the Cross- Language Evaluation Forum 
for  European  Languages.  September,  2018  (pp.  247‚Äì 266).  Springer. 
ISBN:  978- 3- 319- 98932- 7.  Retrieved  from  https://link.sprin ger.com/
chapt er/10.1007/  978- 3- 319-  98932- 7_24

Karger, D. N., Conrad, O., B√∂hner, J., Kawohl, T., Kreft, H., Soria- Auza, R. 
W., Zimmermann, N., Linder, H. P., & Kessler, M. (2016). Climatologies 
at  high  resolution  for  the  earth's  land  surface  areas.  arXiv  Preprint 
arXiv:1607.00217.

Kery, M., Royle, J. A., Schmid, H., Schaub, M., Volet, B., Haefliger, G., & 
Zbinden, N. (2010). Site- occupancy distribution modeling to correct 
population- trend  estimates  derived  from  opportunistic  observa-
tions. Conservation Biology, 24(5), 1388‚Äì 1397.

Koshkina, V., Wang, Y., Gordon, A., Dorazio, R. M., White, M., & Stone, L. 
(2017). Integrated species distribution models: Combining presence- 
background data and site- occupancy data with imperfect detection. 
Methods in Ecology and Evolution, 8(4), 420‚Äì 430.

Miller,  D.  A.  W.,  Pacifici,  K.,  Sanderlin,  J.  S.,  &  Reich,  B.  J.  (2019).  The 
recent  past  and  promising  future  for  data  integration  methods  to 
estimate species' distributions. Methods in Ecology and Evolution, 10, 
22‚Äì 37.

Mod,  H.  K.,  Scherrer,  D.,  Luoto,  M.,  &  Guisan,  A.  (2016).  What  we  use 
is not what we know: Environmental predictors in plant distribution 
models. Journal of Vegetation Science, 27(6), 1308‚Äì 1322.

Panagos,  P.  (2006).  The  European  soil  database.  GEO:  Connexion,  5(7), 

32‚Äì 33.

Phillips, S. J., Dud√≠k, M., Elith, J., Graham, C. H., Lehmann, A., Leathwick, 
J., & Ferrier, S. (2009). Sample selection bias and presence- only dis-
tribution models: Implications for background and pseudo- absence 
data. Ecological Applications, 19(1), 181‚Äì 197.

Renner,  I.  W.,  Elith,  J.,  Baddeley,  A.,  Fithian,  W.,  Hastie,  T.,  Phillips,  S. 
J.,  Popovic,  G.,  &  Warton,  D.  I.  (2015).  Point  process  models  for 
presence- only  analysis.  Methods  in  Ecology  and  Evolution,  6(4), 
366‚Äì 379.

Simmonds, E. G., Jarvis, S. G., Henrys, P. A., Isaac, N. J., & O'Hara, R. B. 
(2020).  Is  more  data  always  better?  A  simulation  study  of  benefits 
and limitations of integrated distribution models. Ecography, 43(10), 
1413‚Äì 1422.

Sober√≥n, J., & Peterson, T. (2004). Biodiversity informatics: Managing and 
applying primary biodiversity data. Philosophical Transactions of the Royal 
Society of London. Series B: Biological Sciences, 359(1444), 689‚Äì 698.
Teacher,  A.  G.,  Griffiths,  D.  J.,  Hodgson,  D.  J.,  &  Inger,  R.  (2013). 
Smartphones  in  ecology  and  evolution:  A  guide  for  the  app- 
rehensive. Ecology and Evolution, 3(16), 5268‚Äì 5278.

Van  Liedekerke,  M.,  Jones,  A.,  &  Panagos,  P.  (2006).  ESDBv2  Raster 
Library  -   a  set  of  rasters  derived  from  the  European  Soil  Database 
distribution  v2.0  (published  by  the  European  Commission  and  the 
European Soil Bureau Network, CD- ROM, EUR 19945 EN). Retrieved 
from  https://esdac.jrc.ec.europa.eu/conte nt/europ ean- soil- datab ase- 
 v2- raste r- libra ry- 1kmx1km

Warton, D. I., Renner, I. W., & Ramp, D. (2013). Model- based control of 
observer bias for the analysis of presence- only data in ecology. PLoS 
One, 8(11), e79168.

Warton, D., & Shepherd, L. (2010). Poisson point process models solve 
the  ‚Äúpseudo- absence  problem‚Äù  for  presence- only  data  in  ecol-
ogy.  The  Annals  of  Applied  Statistics,  4(3),  1383‚Äì 1402.  https://doi.
org/10.2307/29765559

Zomer, R. J., Bossio, D. A., Trabucco, A., Yuanjie, L., Gupta, D. C., & Singh, 
V. P. (2007). Trees and water: Smallholder agroforestry on irrigated lands 
in Northern India (Vol. 122). IWMI.

Zomer, R. J., Trabucco, A., Bossio, D. A., & Verchot, L. V. (2008). Climate 
change  mitigation:  A  spatial  analysis  of  global  land  suitability  for 
clean  development  mechanism  afforestation  and  reforestation. 
Agriculture, Ecosystems & Environment, 126(1), 67‚Äì 80.

S U P P O R T I N G I N FO R M AT I O N

Additional  supporting  information  may  be  found  online  in  the 

Supporting Information section.

How to cite this article: Botella C, Joly A, Bonnet P, Munoz F, 

Monestiez P. Jointly estimating spatial sampling effort and 

habitat suitability for multiple species from opportunistic 

presence- only data. Methods Ecol Evol. 2021;00:1‚Äì 13. https://

doi.org/10.1111/2041-210X.13565

BOTELLA ET AL.